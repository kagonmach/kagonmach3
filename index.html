<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="EVg4xnJw3nUhs6KE6N3ohNVe0wAapAHLhykoi3XoFV4" />
    <title>ã‹ã”ã‚“ã¾ãƒãƒ£ãƒ³ãƒãƒ«22</title>
    <link rel="stylesheet" href="kagoshima1.css">
</head>
<body>
    <header>
        <h1>ã‹ã”ã‚“ã¾ãƒãƒ£ãƒãƒ«</h1> 
        <nav>
            <ul>
                <li><a href="kagoshima9.html">ã‚°ãƒ«ãƒ¡</a></li>
                <li><a href="kagoshima10.html">æ¸©æ³‰</a></li>
                <li><a href="kagoshima11.html">ã‚¤ãƒ™ãƒ³ãƒˆ</a></li>
                <li><a href="kagoshima12.html">ã‚¢ã‚¯ã‚»ã‚¹</a></li>
                <li><a href="kagoshima13.html">ãŠæ°—ã«å…¥ã‚Šã®å ´æ‰€</a></li>
                <li><a href="kagoshima.14.html">ä¾¿åˆ©ãªæƒ…å ±</a></li>
                <li><a href="kagoshima15.html">æ„šç—´</a></li>
            </ul>
        </nav>
        <img src="sakurajima22.png" alt="">
    </header>
    <main>
        
        <section class="hero">
            <img src="sakurajima.jpg" alt="é¹¿å…å³¶å¸‚ã‹ã‚‰ã®æ¡œå³¶">
        </section>
        <section class="about">
            <div class="container"></div>
            <h2>ã‹ã”ã‚“ã¾ãƒãƒ£ãƒ³ãƒãƒ«ã®ä½¿ã„æ–¹</h2>
            <p>ã“ã®ã‚µã‚¤ãƒˆã¯ã€é¹¿å…å³¶ã®ã„ã„ã¨ã“ã‚ã‚„ä¾¿åˆ©ãªæƒ…å ±ã‚’å…±æœ‰ã™ã‚‹ã‚µã‚¤ãƒˆã§ã™ã€‚
                #ã‚°ãƒ«ãƒ¡ã€ï¼ƒæ¸©æ³‰ã€ï¼ƒã‚¤ãƒ™ãƒ³ãƒˆã€ï¼ƒäº¤é€šã€ï¼ƒãŠæ°—ã«å…¥ã‚Šã®å ´æ‰€ã€ï¼ƒä¾¿åˆ©ãªæƒ…å ±ã“ã‚Œã‚‰ã„ãšã‚Œã‹ã®ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ã‚’ã‚³ãƒ¡ãƒ³ãƒˆå†…ã«å…¥ã‚Œã¦æŠ•ç¨¿ã—ã¦ãã ã•ã„ã€‚
                ã“ã®ã‚µã‚¤ãƒˆã‚’é€šã—ã¦ã€ä»Šã¾ã§çŸ¥ã‚‰ãªã‹ã£ãŸé¹¿å…å³¶ã®é­…åŠ›ã‚’æ·±ã‚ã¦ã„ã“ã†ã€‚ã‚‚ã¡ã‚ã‚“æ„šç—´ã‚‚å¤§æ­“è¿ï¼ˆæ¡œå³¶ã®ç°ãŒã ã‚‹ã„ãªã©ã€‚ã€‚ã€‚ï¼‰ã“ã®ã‚µã‚¤ãƒˆã¯ä¸–ç•Œã§å”¯ä¸€ã®é¹¿å…å³¶ã«ã¤ã„ã¦èªã‚‹ã‚µã‚¤ãƒˆã€‚
                å†™çœŸå”åŠ›ï¼šå…¬ç›Šç¤¾å›£æ³•äººã€€é¹¿å…å³¶çœŒè¦³å…‰é€£ç›Ÿã€Â©ken.n.miffy.752
            </p>

        </section>
    
    </main>
    <aside>
  <input id="author" placeholder="ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’ã„ã‚Œã¦ã­ï¼ˆçœç•¥å¯ï¼‰">
     <textarea id="content" placeholder="æŠ•ç¨¿å†…å®¹"></textarea>
      <input id="imageInput" type="file" accept="image/*">
      <button id="submitBtn">æŠ•ç¨¿</button>
      <div id="posts"></div>
    </aside>
ã€€ã€€<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
ã€€ã€€<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    
<script>
// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyAIiRPFlbp6MBTnKeR4_6T8z4weGwa3Bkc",
  authDomain: "kagoshima-sns.firebaseapp.com",
  projectId: "kagoshima-sns",
  storageBucket: "kagoshima-sns.firebasestorage.app",
  messagingSenderId: "771420231919",
  appId: "1:771420231919:web:c7a3ce1e49b0946d79631a"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
    db.collection("test").add({
  message: "Firestoreæ¥ç¶šãƒ†ã‚¹ãƒˆ",
  time: new Date()
})
.then(() => {
  alert("âœ… Firestoreã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã§ãã¾ã—ãŸï¼");
})
.catch((error) => {
  alert("âŒ Firestoreæ¥ç¶šã‚¨ãƒ©ãƒ¼: " + error);
});


const $posts = document.getElementById('posts');
const escapeHtml = str => str.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');

function renderPost(doc){
  const data = doc.data();
  const div = document.createElement('div');
  div.className = 'post';
  div.dataset.id = doc.id;
  div.innerHTML = `
    <strong>${escapeHtml(data.author||'åç„¡ã—')}</strong>
    <div>${escapeHtml(data.content)}</div>
    ${data.image||'' ? `<img src="${data.image}">` : ''}
    <div class="actions">
      <button class="likeBtn">ğŸ‘ ${data.likes||0}</button>
      <button class="deleteBtn">å‰Šé™¤</button>
    </div>
  `;
  $posts.prepend(div);

  // ã‚¤ãƒ™ãƒ³ãƒˆ
  div.querySelector('.likeBtn').addEventListener('click', ()=>{
    const ref = db.collection('posts').doc(doc.id);
    ref.update({likes: firebase.firestore.FieldValue.increment(1)});
  });
  div.querySelector('.deleteBtn').addEventListener('click', ()=>{
    const user = document.getElementById('author').value.trim() || 'åç„¡ã—';
    if(user !== (data.author||'åç„¡ã—')){ alert('è‡ªåˆ†ã®æŠ•ç¨¿ã—ã‹å‰Šé™¤ã§ãã¾ã›ã‚“'); return; }
    if(confirm('æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')){
      db.collection('posts').doc(doc.id).delete();
    }
  });
}

// Firestoreãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å–å¾—
db.collection('posts').orderBy('createdAt','desc').onSnapshot(snapshot=>{
  $posts.innerHTML='';
  snapshot.forEach(doc=>renderPost(doc));
});

// ç”»åƒã‚’Base64ã«å¤‰æ›
function toBase64(file){return new Promise(res=>{
  if(!file) return res(null);
  const reader = new FileReader();
  reader.onload = e=>res(e.target.result);
  reader.readAsDataURL(file);
});}

document.getElementById('submitBtn').addEventListener('click', async ()=>{
  const author = document.getElementById('author').value.trim();
  const content = document.getElementById('content').value.trim();
  const file = document.getElementById('imageInput').files[0];
  if(!content){alert('æœ¬æ–‡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');return;}
  const image = await toBase64(file);
  await db.collection('posts').add({
    author, content, image,
    likes:0,
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  });
  document.getElementById('content').value='';
  document.getElementById('imageInput').value='';
});
</script>


</body>

</html>




















