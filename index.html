<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="EVg4xnJw3nUhs6KE6N3ohNVe0wAapAHLhykoi3XoFV4" />
    <title>かごんまチャンネル</title>
    <link rel="stylesheet" href="kagoshima1.css">
</head>
<body>
    <header>
        <h1>かごんまチャネル</h1> 
        <nav>
            <ul>
                <li><a href="kagoshima9.html">グルメ</a></li>
                <li><a href="kagoshima10.html">温泉</a></li>
                <li><a href="kagoshima11.html">イベント</a></li>
                <li><a href="kagoshima12.html">交通</a></li>
                <li><a href="kagoshima13.html">お気に入りの場所</a></li>
                <li><a href="kagoshima.14.html">便利な情報</a></li>
                <li><a href="kagoshima15.html">愚痴</a></li>
            </ul>
        </nav>
        <img src="sakurajima22.png" alt="">
    </header>
    <main>
        
        <section class="hero">
            <img src="sakurajima.jpg" alt="鹿児島市からの桜島">
        </section>
        <section class="about">
            <div class="container"></div>
            <h2>かごんまチャンネルの使い方</h2>
            <p>このサイトは、鹿児島のいいところや便利な情報を共有するサイトです。
                #グルメ、＃温泉、＃イベント、＃交通、＃お気に入りの場所、＃便利な情報これらいずれかのハッシュタグをコメント内に入れて投稿してください。
                このサイトを通して、今まで知らなかった鹿児島の魅力を深めていこう。もちろん愚痴も大歓迎（桜島の灰がだるいなど。。。）このサイトは世界で唯一の鹿児島について語るサイト。
                写真協力：公益社団法人　鹿児島県観光連盟、©ken.n.miffy.752
            </p>

        </section>
    </section>
    </main>
    <aside>
  <input id="author" placeholder="名前（省略可）">
     <textarea id="content" placeholder="投稿内容"></textarea>
      <input id="imageInput" type="file" accept="image/*">
      <button id="submitBtn">投稿</button>
      <div id="posts"></div>
    </aside>
<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyAz9_Qiy4pTBaRuMI1cYWwzo1FZBjn0XeM",
    authDomain: "post-plattform.firebaseapp.com",
    databaseURL: "https://post-plattform-default-rtdb.firebaseio.com",
    projectId: "post-plattform",
    storageBucket: "post-plattform.firebasestorage.app",
    messagingSenderId: "223979841983",
    appId: "1:223979841983:web:d858c36b5dd8f641f6590a",
    measurementId: "G-X3ZSQ8WFFM"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
    // 投稿表示
  function renderPost(doc){
    const data = doc.data();
    const div = document.createElement('div');
    div.className = 'post';
    div.innerHTML = `<strong>${escapeHtml(data.author||'名無し')}</strong>
      <div>${escapeHtml(data.content)}</div>
      ${data.image||'' ? `<img src="${data.image}">` : ''}`;
    $posts.prepend(div);
  }

  // Firestoreのリアルタイム取得
  db.collection('posts').orderBy('createdAt','desc').onSnapshot(snapshot=>{
    $posts.innerHTML='';
    snapshot.forEach(doc=>renderPost(doc));
  });

  // 画像をBase64に変換
  function toBase64(file){return new Promise(res=>{
    if(!file) return res(null);
    const reader = new FileReader();
    reader.onload = e=>res(e.target.result);
    reader.readAsDataURL(file);
  });}

  document.getElementById('submitBtn').addEventListener('click', async ()=>{
    const author = document.getElementById('author').value.trim();
    const content = document.getElementById('content').value.trim();
    const file = document.getElementById('imageInput').files[0];
    if(!content){alert('本文を入力してください');return;}
    const image = await toBase64(file);
    await db.collection('posts').add({
      author, content, image,
      createdAt: firebase.firestore.FieldValue.serverTimestamp()
    });
    document.getElementById('author').value='';
    document.getElementById('content').value='';
    document.getElementById('imageInput').value='';
  });
</script>


</body>

</html>









